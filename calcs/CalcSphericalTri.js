/* Copyright (C) 2022 Alma Nuradnan Pramudita (email: gocodealpha@gmail.com)

This file is part of SimAstroPosisi.

SimAstroPosisi is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

SimAstroPosisi is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with SimAstroPosisi. If not, see <https://www.gnu.org/licenses/>. */

let SphereTri=function(a){let e,t,s,o,l,i,n,r,c,u,p,P,I,f,v,d,h,x,y,g,m,b,E,S,R,C,z,T,k,N,w;a.preload=function(){e=a.loadFont("https://anuradnanp.github.io/simastroposisi/aset/Lato-Regular.ttf"),e=a.loadFont("https://anuradnanp.github.io/simastroposisi/aset/Lato-Bold.ttf")},a.setup=function(){a.setAttributes("antialias",!0),t=a.createCanvas(310,310,a.WEBGL),t.position(5,170).style("border-radius","0"),a.createP("panjang sisi merah :").style("font-family","Lato-Regular").style("font-size","14px").style("font-weight","normal").position(10,10).style("width","190px").style("text-align","right").style("color","#ff0000"),s=a.createSlider(20,150,30,.5),s.size(300,15).position(10,30),a.createP("panjang sisi biru :").style("font-family","Lato-Regular").style("font-size","14px").style("font-weight","normal").position(10,60).style("width","190px").style("text-align","right").style("color","#0000ff"),o=a.createSlider(20,150,60,.5),o.size(300,15).position(10,80),a.createP("sudut antara merah dan biru :").style("font-family","Lato-Regular").style("font-size","14px").style("font-weight","normal").position(10,110).style("width","190px").style("text-align","right").style("color","#000000"),l=a.createSlider(20,150,50,.5),l.size(300,15).position(10,130),i=a.createSlider(0,2*a.PI,3*a.PI/2,a.PI/30),i.size(280,15).position(10,450),n=a.createSlider(-a.PI/2+.1,a.PI/2-.1,a.PI/4,a.PI/20),n.size(280,15).position(160,300).style("transform","rotate(90deg)"),a.frameRate(5),r=a.createP(""),r.position(210,10).id("side1Val").style("font-family","Lato-Bold").style("font-size","17px").style("color","#ffffff").style("text-shadow","0px 0px 4px #ff0000"),c=a.createP(""),c.position(210,60).id("side2Val").style("font-family","Lato-Bold").style("font-size","17px").style("color","#ffffff").style("text-shadow","0px 0px 4px #0000ff"),u=a.createP(""),u.position(210,110).id("sepVal").style("font-family","Lato-Bold").style("font-size","17px").style("color","#ffffff").style("text-shadow","0px 0px 4px #000000")},a.dispVal=function(){document.getElementById("side1Val").textContent=s.value()+"°",document.getElementById("side2Val").textContent=o.value()+"°",document.getElementById("sepVal").textContent=l.value()+"°"},a.draw=function(){a.clear(),a.background("#d79922"),a.angleMode(a.RADIANS),a.textFont(e),a.noStroke(),a.camera(250*a.cos(i.value())*a.cos(n.value()),-250*a.sin(n.value()),250*a.sin(i.value())*a.cos(n.value()),0,0,0,0,1,0),a.push(),a.fill("#ffffff"),a.sphere(90),a.pop(),a.push(),a.noFill(),a.stroke("#bbbbbb"),a.strokeWeight(1.5),a.rotateY(a.PI/2-l.value()/2*a.PI/180),a.circle(0,0,181),a.pop(),a.push(),a.noFill(),a.stroke("#bbbbbb"),a.strokeWeight(1.5),a.rotateY(a.PI/2+l.value()/2*a.PI/180),a.circle(0,0,181),a.pop(),p=a.createVector(-91*a.sin(l.value()/2*a.PI/180)*a.cos(-(90-s.value())*a.PI/180),91*a.sin(-(90-s.value())*a.PI/180),-91*a.cos(l.value()/2*a.PI/180)*a.cos(-(90-s.value())*a.PI/180)),P=a.createVector(-91*a.sin(-l.value()/2*a.PI/180)*a.cos(-(90-o.value())*a.PI/180),91*a.sin(-(90-o.value())*a.PI/180),-91*a.cos(-l.value()/2*a.PI/180)*a.cos(-(90-o.value())*a.PI/180)),I=P.cross(p),a.push(),a.noFill(),a.stroke("#bbbbbb"),a.strokeWeight(1.5),a.rotateY(a.atan2(I.x,I.z)),a.rotateX(a.PI/2+a.acos(I.y/I.mag())),a.circle(0,0,181),a.pop(),a.plotCalc(90-s.value(),90-o.value(),l.value()/2,-l.value()/2),a.push(),a.fill("#000000"),a.textAlign(a.CENTER,a.CENTER),a.textSize(7),a.translate(-100*a.sin((l.value()/2+5)*a.PI/180)*a.cos(-(90-(s.value()+5))*a.PI/180),100*a.sin(-(90-(s.value()+5))*a.PI/180),-100*a.cos((l.value()/2+5)*a.PI/180)*a.cos(-(90-(s.value()+5))*a.PI/180)),a.rotateY(-i.value()+a.PI/2),a.rotateX(n.value()),a.text(a.round(180*f/a.PI,1)+"°",0,0),a.pop(),a.push(),a.fill("#000000"),a.textAlign(a.CENTER,a.CENTER),a.textSize(7),a.translate(-100*a.sin(-(l.value()/2+5)*a.PI/180)*a.cos(-(90-(o.value()+5))*a.PI/180),100*a.sin(-(90-(o.value()+5))*a.PI/180),-100*a.cos(-(l.value()/2+5)*a.PI/180)*a.cos(-(90-(o.value()+5))*a.PI/180)),a.rotateY(-i.value()+a.PI/2),a.rotateX(n.value()),a.text(a.round(180*v/a.PI,1)+"°",0,0),a.pop(),a.push(),a.fill("#00ff00"),a.textAlign(a.CENTER,a.CENTER),a.textSize(7),a.translate(-100*a.sin((0-5*a.cos(f))*a.PI/180)*a.cos(-(d[7][1]-5*a.sin(f))*a.PI/180),100*a.sin(-(d[7][1]-5*a.sin(f))*a.PI/180),-100*a.cos((0-5*a.cos(f))*a.PI/180)*a.cos(-(d[7][1]-5*a.sin(f))*a.PI/180)),a.rotateY(-i.value()+a.PI/2),a.rotateX(n.value()),a.text(a.round(180*h/a.PI,1)+"°",0,0),a.pop(),a.push(),a.fill("#000000"),a.textAlign(a.CENTER,a.CENTER),a.textSize(7),a.translate(-100*a.sin(180*a.PI/180)*a.cos(-85*a.PI/180),100*a.sin(-85*a.PI/180),-100*a.cos(180*a.PI/180)*a.cos(-85*a.PI/180)),a.rotateY(-i.value()+a.PI/2),a.rotateX(n.value()),a.text(l.value()+"°",0,0),a.pop(),a.push(),a.fill("#ff0000"),a.textAlign(a.CENTER,a.CENTER),a.textSize(7),a.translate(-100*a.sin((l.value()/2+15)*a.PI/180)*a.cos(-(90-s.value()/2)*a.PI/180),100*a.sin(-(90-s.value()/2)*a.PI/180),-100*a.cos((l.value()/2+15)*a.PI/180)*a.cos(-(90-s.value()/2)*a.PI/180)),a.rotateY(-i.value()+a.PI/2),a.rotateX(n.value()),a.text(s.value()+"°",0,0),a.pop(),a.push(),a.fill("#0000ff"),a.textAlign(a.CENTER,a.CENTER),a.textSize(7),a.translate(-100*a.sin(-(l.value()/2+15)*a.PI/180)*a.cos(-(90-o.value()/2)*a.PI/180),100*a.sin(-(90-o.value()/2)*a.PI/180),-100*a.cos(-(l.value()/2+15)*a.PI/180)*a.cos(-(90-o.value()/2)*a.PI/180)),a.rotateY(-i.value()+a.PI/2),a.rotateX(n.value()),a.text(o.value()+"°",0,0),a.pop(),a.dispVal()},a.plotCalc=function(e,t,s,o){for(x=(90-e)*a.PI/180,y=(90-t)*a.PI/180,g=(s-o)*a.PI/180,h=a.acos(a.cos(x)*a.cos(y)+a.sin(x)*a.sin(y)*a.cos(g)),f=a.acos((a.cos(y)-a.cos(x)*a.cos(h))/a.sin(x)/a.sin(h)),v=a.acos((a.cos(x)-a.cos(y)*a.cos(h))/a.sin(y)/a.sin(h)),m=a.round((a.max(a.abs(s-o),180*x/a.PI,180*y/a.PI)+45)/9,0),d=[],b=0;b<m+1;b++)E=h/m*b,S=a.acos(a.cos(y)*a.cos(E)+a.sin(y)*a.sin(E)*a.cos(v)),R=a.acos((a.cos(E)-a.cos(y)*a.cos(S))/a.sin(y)/a.sin(S)),z=0==b?(C=t,o):(C=180*(a.PI/2-S)/a.PI,o+180*R/a.PI),d.push([z,C]);for(a.push(),a.noFill(),a.stroke("#00ff00"),a.strokeWeight(1.5),a.beginShape(),b=0;b<m+1;b++)a.vertex(-91*a.sin(d[b][0]*a.PI/180)*a.cos(-d[b][1]*a.PI/180),91*a.sin(-d[b][1]*a.PI/180),-91*a.cos(d[b][0]*a.PI/180)*a.cos(-d[b][1]*a.PI/180));for(a.endShape(),a.pop(),a.push(),a.stroke("#ff0000"),a.strokeWeight(1.5),a.beginShape(),b=0;b<m+1;b++)C=90-b*(90-e)/m,z=s,a.vertex(-91*a.sin(z*a.PI/180)*a.cos(-C*a.PI/180),91*a.sin(-C*a.PI/180),-91*a.cos(z*a.PI/180)*a.cos(-C*a.PI/180));for(a.endShape(),a.pop(),a.push(),a.stroke("#0000ff"),a.strokeWeight(1.5),a.beginShape(),b=0;b<m+1;b++)C=90-b*(90-t)/m,z=o,a.vertex(-91*a.sin(z*a.PI/180)*a.cos(-C*a.PI/180),91*a.sin(-C*a.PI/180),-91*a.cos(z*a.PI/180)*a.cos(-C*a.PI/180));for(a.endShape(),a.pop(),a.push(),a.fill("#00000033"),a.noStroke(),a.beginShape(a.TRIANGLE_STRIP),b=0;b<m;b++)for(T=0;T<m+1;T++)k=d[T][1]+b*(90-d[T][1])/m,N=d[T][1]+(b+1)*(90-d[T][1])/m,w=d[T][0],a.vertex(-91*a.sin(w*a.PI/180)*a.cos(-k*a.PI/180),91*a.sin(-k*a.PI/180),-91*a.cos(w*a.PI/180)*a.cos(-k*a.PI/180)),a.vertex(-91*a.sin(w*a.PI/180)*a.cos(-N*a.PI/180),91*a.sin(-N*a.PI/180),-91*a.cos(w*a.PI/180)*a.cos(-N*a.PI/180));a.endShape(),a.pop()},a.mousePressed=function(){0<a.mouseX&&a.mouseX<a.width&&-200<a.mouseY&&a.mouseY<470&&a.frameRate(20)},a.mouseReleased=function(){a.frameRate(5)}},SketSphericalTri=new p5(SphereTri,"CalcSphericalTri");

/* Copyright (C) 2022 Alma Nuradnan Pramudita (email: gocodealpha@gmail.com)

This file is part of SimAstroPosisi.

SimAstroPosisi is free software: you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

SimAstroPosisi is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.

You should have received a copy of the GNU General Public License along with SimAstroPosisi. If not, see <https://www.gnu.org/licenses/>. */

let PosPlanet=function(a){var t=10,e=14;let s,o,l,n,i,r,u,f,c,h,p,M,P,m,d,I,k,b,g,x,y,v,B,R,A,z,S,C,L,F,j,w,T,J,E,N,O,D,G,W,X,Y,H,V,q,K,Q,U,Z;a.preload=function(){s=a.loadFont("https://anuradnanp.github.io/simastroposisi/aset/Lato-Regular.ttf"),o=a.loadFont("https://anuradnanp.github.io/simastroposisi/aset/Lato-Bold.ttf")},a.setup=function(){a.createCanvas(320,557),l=a.createGraphics(310,314),n=a.createRadio(),n.option("planet dalam"),n.option("planet luar"),n.selected("planet luar"),n.position(20,38).addClass("leaveAlone"),n.size(250,e),n.style("font-family","Lato-Regular"),n.style("font-size","14px"),i=a.createSlider(0,1.1,0,.1),i.position(20,84),i.size(250,e),r=a.createButton("- 1 hari"),r.position(t,118).addClass("leaveAlone"),r.mousePressed(a.min1),r.style("font-family","Lato-Regular"),r.style("font-size","14px"),h=a.createButton("+ 1 hari"),h.position(t,152).addClass("leaveAlone"),h.mousePressed(a.plu1),h.style("font-family","Lato-Regular"),h.style("font-size","14px"),u=a.createButton("- 10 hari"),u.position(75,118).addClass("leaveAlone"),u.mousePressed(a.min10),u.style("font-family","Lato-Regular"),u.style("font-size","14px"),p=a.createButton("+ 10 hari"),p.position(75,152).addClass("leaveAlone"),p.mousePressed(a.plu10),p.style("font-family","Lato-Regular"),p.style("font-size","14px"),f=a.createButton("- 30 hari"),f.position(150,118).addClass("leaveAlone"),f.mousePressed(a.min30),f.style("font-family","Lato-Regular"),f.style("font-size","14px"),M=a.createButton("+ 30 hari"),M.position(150,152).addClass("leaveAlone"),M.mousePressed(a.plu30),M.style("font-family","Lato-Regular"),M.style("font-size","14px"),c=a.createButton("- 100 hari"),c.position(225,118).addClass("leaveAlone"),c.mousePressed(a.min100),c.style("font-family","Lato-Regular"),c.style("font-size","14px"),P=a.createButton("+ 100 hari"),P.position(225,152).addClass("leaveAlone"),P.mousePressed(a.plu100),P.style("font-family","Lato-Regular"),P.style("font-size","14px"),m=2459846,a.frameRate(5)},a.min1=function(){--m},a.plu1=function(){m+=1},a.min10=function(){m-=10},a.plu10=function(){m+=10},a.min30=function(){m-=30},a.plu30=function(){m+=30},a.min100=function(){m-=100},a.plu100=function(){m+=100},a.mousePressed=function(){0<a.mouseX&&a.mouseX<a.width&&0<a.mouseY&&a.mouseY<a.height&&a.frameRate(20)},a.mouseReleased=function(){a.frameRate(5)},a.jd2greg=function(){switch(d=m+.5,I=Math.floor(d),k=d-I,b=I<2299161?I:(g=Math.floor((I-1867216.25)/36524.25),I+1+g-Math.floor(g/4)),x=b+1524,y=Math.floor((x-122.1)/365.25),v=Math.floor(365.25*y),B=Math.floor((x-v)/30.6001),R=x-v-Math.floor(30.6001*B),B<14?A=B-1:14!=B&&15!=B||(A=B-13),2<A?z=y-4716:1!=A&&2!=A||(z=y-4715),A){case 1:S="Januari";break;case 2:S="Februari";break;case 3:S="Maret";break;case 4:S="April";break;case 5:S="Mei";break;case 6:S="Juni";break;case 7:S="Juli";break;case 8:S="Agustus";break;case 9:S="September";break;case 10:S="Oktober";break;case 11:S="November";break;case 12:S="Desember"}return C=[z,S,R],C},a.draw=function(){switch(a.background("#d79922"),a.angleMode(a.RADIANS),i.value()){case 0:L="Matahari";break;case.1:L="Matahari -|--------- Bumi";break;case.2:L="Matahari --|-------- Bumi";break;case.3:L="Matahari ---|------- Bumi";break;case.4:L="Matahari ----|------ Bumi";break;case.5:L="Matahari -----|----- Bumi";break;case.6:L="Matahari ------|---- Bumi";break;case.7:L="Matahari -------|--- Bumi";break;case.8:L="Matahari --------|-- Bumi";break;case.9:L="Matahari ---------|- Bumi";break;case 1:L="Bumi + orbit";break;case 1.1:L="Bumi + arah + jarak"}if(F=[.387,.723,1.52,5.2,9.57],j=[.241,.615,1.88,11.9,29.4],a.jd2greg(),a.fill("#000000"),a.textFont(s),a.textSize(14),a.noStroke(),a.textAlign(a.LEFT,a.TOP),a.text("planet yang dilihat dari Bumi : ",t,t,250,e),a.text("pusat pandang : ",t,64,200,e),a.textFont(o),a.text("["+L+"]",110,64,200,e),a.textFont(o),a.textAlign(a.RIGHT,a.TOP),a.textSize(14),a.text("susunan planet-planet pada tanggal",300,510),a.textSize(20),a.text(C[2]+" "+C[1]+" "+C[0],300,525),l.background("#d79922"),"planet dalam"==n.value()?(J=[100*Math.cos(2*Math.PI*(m-2459846)/365.24219+.16913*Math.PI/180)+155,-100*Math.sin(2*Math.PI*(m-2459846)/365.24219+.16913*Math.PI/180)+155],O=[100*F[0]*Math.cos(2*Math.PI*(m-2459846)/(365.24219*j[0])+359.89164*Math.PI/180)+155,100*-F[0]*Math.sin(2*Math.PI*(m-2459846)/(365.24219*j[0])+359.89164*Math.PI/180)+155],D=[100*F[1]*Math.cos(2*Math.PI*(m-2459846)/(365.24219*j[1])+161.48632*Math.PI/180)+155,100*-F[1]*Math.sin(2*Math.PI*(m-2459846)/(365.24219*j[1])+161.48632*Math.PI/180)+155]):(G=[F[2]/F[4]*150*Math.cos(2*Math.PI*(m-2459846)/(365.24219*j[2])+34.34596*Math.PI/180)+155,-F[2]/F[4]*150*Math.sin(2*Math.PI*(m-2459846)/(365.24219*j[2])+34.34596*Math.PI/180)+155],W=[F[3]/F[4]*150*Math.cos(2*Math.PI*(m-2459846)/(365.24219*j[3])+3.02071*Math.PI/180)+155,-F[3]/F[4]*150*Math.sin(2*Math.PI*(m-2459846)/(365.24219*j[3])+3.02071*Math.PI/180)+155],X=[150*Math.cos(2*Math.PI*(m-2459846)/(365.24219*j[4])+323.13918*Math.PI/180)+155,-150*Math.sin(2*Math.PI*(m-2459846)/(365.24219*j[4])+323.13918*Math.PI/180)+155],J=[1/F[4]*150*Math.cos(2*Math.PI*(m-2459846)/365.24219+.16913*Math.PI/180)+155,-1/F[4]*150*Math.sin(2*Math.PI*(m-2459846)/365.24219+.16913*Math.PI/180)+155]),w=1.1==i.value()?1:i.value(),E=[(1-w)*J[0]+155*w,(1-w)*J[1]+155*w],N=[155-w*J[0]+155*w,155-w*J[1]+155*w],"planet dalam"==n.value()?(Y=[O[0]-w*J[0]+155*w,O[1]-w*J[1]+155*w],H=[D[0]-w*J[0]+155*w,D[1]-w*J[1]+155*w]):(V=[G[0]-w*J[0]+155*w,G[1]-w*J[1]+155*w],q=[W[0]-w*J[0]+155*w,W[1]-w*J[1]+155*w],K=[X[0]-w*J[0]+155*w,X[1]-w*J[1]+155*w]),Q=500,l.noStroke(),U=l.atan2(E[1]-N[1],E[0]-N[0]),l.translate(E[0],E[1]),l.rotate(U),l.fill("#4753b7"),l.rect(0,-.5*Q,Q,Q),l.rotate(-U),l.translate(-E[0],-E[1]),l.noFill(),l.stroke("#ffffff"),l.strokeWeight(.5),i.value()<1.1)"planet dalam"==n.value()?(l.circle(N[0],N[1],200*F[0]),l.circle(N[0],N[1],200*F[1]),l.circle(N[0],N[1],200)):(l.circle(N[0],N[1],1/F[4]*300),l.circle(N[0],N[1],F[2]/F[4]*300),l.circle(N[0],N[1],F[3]/F[4]*300),l.circle(N[0],N[1],300));else{for(l.translate(E[0],E[1]),T=0;T<6;T++)l.rotate(-T*Math.PI/6),l.line(-1e3,0,1e3,0),l.rotate(T*Math.PI/6);for(l.translate(-E[0],-E[1]),T=1;T<9;T++)l.circle(E[0],E[1],50*T)}l.noStroke(),l.textSize(12),l.textAlign(l.CENTER),l.textFont(s),l.fill("#ffffff"),Z=l.atan2(N[0]-E[0],-N[1]+E[1]),"planet dalam"==n.value()?(l.push(),l.translate(.8*(-N[1]+E[1])+E[0]-5*l.cos(Z+l.PI/2),.8*(N[0]-E[0])+E[1]-5*l.sin(Z+l.PI/2)),l.rotate(Z),l.text("fajar\nakan siang",0,0),l.pop(),l.push(),l.translate(.8*(N[1]-E[1])+E[0]+5*l.cos(Z+l.PI/2),.8*(-N[0]+E[0])+E[1]+5*l.sin(Z+l.PI/2))):(l.push(),l.translate(4.8*(-N[1]+E[1])+E[0]-5*l.cos(Z+l.PI/2),4.8*(N[0]-E[0])+E[1]-5*l.sin(Z+l.PI/2)),l.rotate(Z),l.text("fajar\nakan siang",0,0),l.pop(),l.push(),l.translate(4.8*(N[1]-E[1])+E[0]+5*l.cos(Z+l.PI/2),4.8*(-N[0]+E[0])+E[1]+5*l.sin(Z+l.PI/2))),l.rotate(Z+l.PI),l.text("senja\nakan malam",0,0),l.pop(),l.stroke("#000000"),l.strokeWeight(1),l.fill("#ffff00"),l.circle(N[0],N[1],7),l.fill("#0000ff"),l.circle(E[0],E[1],7),"planet dalam"==n.value()?(l.fill("#777777"),l.circle(Y[0],Y[1],7),l.fill("#ff0000"),l.circle(H[0],H[1],7),l.push(),l.noStroke(),l.fill("#ffffff"),l.push(),Z=1.1==i.value()?l.atan2(Y[1]-155,Y[0]-155):l.atan2(Y[1]-N[1],Y[0]-N[0]),l.translate(Y[0]+12*l.cos(Z),Y[1]+12*l.sin(Z)),l.rotate(Z+l.PI/2),l.text("Merkurius",0,0),l.pop(),l.push(),Z=1.1==i.value()?l.atan2(H[1]-155,H[0]-155):l.atan2(H[1]-N[1],H[0]-N[0]),l.translate(H[0]+12*l.cos(Z),H[1]+12*l.sin(Z)),l.rotate(Z+l.PI/2),l.text("Venus",0,0)):(l.fill("#ff0000"),l.circle(V[0],V[1],7),l.fill("#ff5500"),l.circle(q[0],q[1],7),l.fill("#ffaa00"),l.circle(K[0],K[1],7),l.push(),l.noStroke(),l.fill("#ffffff"),l.push(),Z=1.1==i.value()?l.atan2(V[1]-155,V[0]-155):l.atan2(V[1]-N[1],V[0]-N[0]),l.translate(V[0]+12*l.cos(Z),V[1]+12*l.sin(Z)),l.rotate(Z+l.PI/2),l.text("Mars",0,0),l.pop(),l.push(),Z=1.1==i.value()?l.atan2(q[1]-155,q[0]-155):l.atan2(q[1]-N[1],q[0]-N[0]),l.translate(q[0]+12*l.cos(Z),q[1]+12*l.sin(Z)),l.rotate(Z+l.PI/2),l.text("Jupiter",0,0),l.pop(),l.push(),Z=1.1==i.value()?l.atan2(K[1]-155,K[0]-155):l.atan2(K[1]-N[1],K[0]-N[0]),l.translate(K[0]+12*l.cos(Z),K[1]+12*l.sin(Z)),l.rotate(Z+l.PI/2),l.text("Saturnus",0,0)),l.pop(),l.pop(),a.image(l,5,190)}},sketPosPlanet=new p5(PosPlanet,"CalcPosPlanet");
